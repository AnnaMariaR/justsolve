<button (click)="goBack()">← Back to list</button>

@if (debt) {
  <h2>Debt #{{ debt.id }}</h2>
  <p><strong>Debtor:</strong> {{ debt.debtor_name }}</p>
  <p><strong>Amount:</strong> {{ debt.amount | number:'1.2-2' }} EUR</p>
  <p><strong>Days overdue:</strong> {{ debt.days_overdue }}</p>
  <p><strong>Status:</strong> {{ debt.status }}</p>
  @if (debt.last_action) {
    <p>
      <strong>Last action:</strong> {{ debt.last_action }}
      @if (debt.last_action_at) {
        <span>
          ({{ debt.last_action_at | date:'short' }})
        </span>
      }
    </p>
  }

  <hr />

  <button (click)="loadSuggestion()" [disabled]="loadingSuggestion">
    {{ loadingSuggestion ? 'Loading suggestion…' : 'Get suggested action' }}
  </button>

  @if (suggestion) {
    <div style="margin-top: 1rem;">
      <p><strong>Suggested action:</strong> {{ suggestion.action }}</p>
      <p><em>{{ suggestion.reason }}</em></p>
    </div>
  }

  <div style="margin-top: 1rem;">
    <p><strong>Apply action:</strong></p>
    <button (click)="applyAction('SEND_REMINDER')" [disabled]="applying" style="margin-right: 0.5rem;">
      {{ applying ? 'Applying…' : 'Send Reminder' }}
    </button>
    <button (click)="applyAction('OFFER_PAYMENT_PLAN')" [disabled]="applying" style="margin-right: 0.5rem;">
      {{ applying ? 'Applying…' : 'Offer Payment Plan' }}
    </button>
    <button (click)="applyAction('ESCALATE_LEGAL')" [disabled]="applying">
      {{ applying ? 'Applying…' : 'Escalate to Legal' }}
    </button>
  </div>
} @else {
  <p>Loading debt…</p>
}